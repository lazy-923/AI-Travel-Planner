# AI Travel Planner 产品需求文档 (PRD)

## 1. 项目概述

### 1.1 项目简介

AI Travel Planner 是一款智能化的Web旅行规划应用，旨在通过人工智能技术，为用户提供个性化、便捷、高效的旅行计划生成与管理服务。用户只需通过简单的自然语言（语音或文字）输入，即可获得包含交通、住宿、景点、餐饮在内的完整行程方案。

### 1.2 目标用户

- 追求个性化旅行体验的年轻用户。
- 希望节省旅行规划时间的家庭或团体。
- 对旅行预算有明确要求的用户。
- 喜欢探索新目的地但缺乏规划经验的旅行者。

### 1.3 核心价值

- **智能化与个性化:** 利用大语言模型，深度理解用户需求，生成千人千面的旅行计划。
- **一站式服务:** 集行程规划、预算管理、地图导航于一体，简化用户操作。
- **便捷高效:** 通过语音或文字输入，快速生成详细行程，极大缩短规划时间。
- **数据同步:** 云端存储用户数据，实现多设备无缝切换。

## 2. 功能详述

### 2.1 智能行程规划

- **输入方式:**
    - 支持语音输入，通过Web Speech API进行语音识别。
    - 支持文字直接输入。
- **输入内容:** 用户可以输入包含以下一个或多个维度的自然语言描述：
    - **目的地:** 例如：“日本”、“北京”、“欧洲多国”。
    - **旅行时长:** 例如：“5天”、“一个周末”、“半个月”。
    - **预算:** 例如：“预算1万元”、“人均5000”。
    - **同行人员:** 例如：“带孩子”、“情侣”、“和父母一起”。
    - **旅行偏好:** 例如：“喜欢美食和动漫”、“偏好自然风光”、“想去购物”。
- **输出内容:** AI（调用阿里百炼大语言模型）根据用户输入，自动生成一份包含以下信息的详细旅行计划：
    - **每日行程:** 清晰的时间线，包含上午、下午、晚上的活动安排。
    - **交通建议:** 城市间及市内交通方式推荐（飞机、火车、公交、地铁等）。
    - **住宿推荐:** 根据预算和偏好推荐酒店、民宿等。
    - **景点安排:** 结合用户兴趣推荐必游景点及小众特色地点。
    - **餐饮推荐:** 推荐当地特色美食、网红餐厅等。
    - **活动建议:** 如购物、看演出、亲子活动等。

### 2.2 费用预算与管理

- **智能预算:** AI根据生成的行程计划，结合目的地消费水平，给出一个初步的费用估算，包括交通、住宿、餐饮、门票等。
- **开销记录:** 用户可以在旅行过程中，手动记录实际发生的各项开销。
- **预算分析:** 系统自动对比预算与实际开销，提供简单的图表分析，帮助用户更好地管理旅行财务。

### 2.3 用户管理与数据存储

- **注册与登录:**
    - 提供基于邮箱/手机号的注册和登录系统。
    - 用户认证服务使用 Supabase Auth。
- **用户数据存储:**
    - **旅行计划:** 用户可以保存、查看、编辑和删除多份旅行计划。
    - **个人偏好:** 系统可以保存用户的常用偏好（如预算范围、喜欢的旅行节奏等），用于未来的行程推荐。
    - **费用记录:** 用户的开销记录与特定行程关联。
- **云端同步:**
    - 所有用户数据（旅行计划、偏好、费用记录）均存储在 Supabase 数据库中。
    - 实现数据云端同步，用户可以在任何设备的浏览器上登录账户，查看和修改自己的数据。

### 2.4 地图交互与导航

- **地图展示:**
    - 在生成行程后，首页主界面以地图形式展示。
    - 地图上会清晰地标注出行程计划中涉及的所有地点（景点、餐厅、酒店等）。
- **地点信息:**
    - 点击地图上的标注点，可以显示该地点的详细信息（如名称、简介、图片、用户评价等）。
- **导航功能:**
    - 用户可以点击计划中的某个地点，直接调用高德地图API，启动导航功能，引导用户前往该地点。

## 3. 技术架构

项目采用前后端分离的三层架构模式。

### 3.1 客户端 (Frontend)

- **技术栈:** Next.js + React + Tailwind CSS
- **主要职责:**
    - 构建响应式用户界面，适配不同尺寸的设备。
    - 实现以地图为核心的交互体验。
    - 美观、清晰地展示行程计划。
    - 捕获用户输入（文字和语音），并发送至后端API。
    - 调用高德地图JS API，实现地图展示、标注和导航功能。

### 32. 应用/API服务层 (Backend)

- **技术栈:** Python + FastAPI
- **主要职责:**
    - 提供 RESTful API 接口供前端调用。
    - 处理 HTTP 请求，进行数据校验。
    - 管理用户认证和会话（与Supabase集成）。
    - 作为中间层，调用外部API和AI服务：
        - **语音识别:** 调用Web Speech API进行语音识别。
        - **行程规划:** 调用阿里百炼大语言模型API。
    - 与数据层交互，对用户数据进行增删改查。

### 3.3 数据/AI服务层

- **数据存储:**
    - **数据库:** Supabase (PostgreSQL)，用于存储用户信息、行程计划、费用记录等结构化数据。
- **AI规划:**
    - **大语言模型:** 阿里百炼，用于生成个性化的行程计划和进行费用预算。
- **地理位置服务:**
    - **地图与导航:** 高德地图开放平台，提供地图展示、地理编码、路线规划和导航服务。

## 4. 非功能性需求

### 4.1 API Key 安全管理

- **严禁硬编码:** 绝不允许将任何API Key（Supabase, 阿里百炼, 高德地图）直接写入代码中。
- **配置文件:** 在项目根目录下创建 `.env` 文件，用于统一存储和管理所有API Keys。
- **环境变量:** 后端应用通过读取环境变量的方式来获取API Keys。
- **版本控制忽略:** `.env` 文件必须被添加到 `.gitignore` 文件中，防止被提交到Git仓库。

### 4.2 UI/UX 设计

- **地图为中心:** 界面设计应以地图为主体，行程信息和操作面板作为辅助。
- **清晰直观:** 行程展示应采用时间轴或卡片式设计，信息结构清晰，易于阅读。
- **美观现代:** 使用高质量的图片和现代化的UI组件，提升视觉吸引力。
- **响应式设计:** 确保在桌面和移动设备上都有良好的视觉和交互体验。

### 4.3 软件呈现与流程

1.  **首次访问:** 用户进入应用首页，看到一个简洁的引导界面，提示用户注册或登录。
2.  **注册/登录:** 用户完成注册或登录。
3.  **进入主页:**
    - 主页中央是交互式地图。
    - 页面下方或侧边是输入区域，包含一个文本输入框和一个语音输入按钮。
4.  **输入需求:**
    - 用户通过语音输入：“我想去日本，5天，预算1万元，喜欢美食和动漫，带孩子”。
    - 或者在文本框中输入同样的内容。
5.  **生成计划:**
    - 系统将用户需求发送至后端。
    - 后端调用AI服务，生成详细的旅行计划。
    - 计划生成后，返回给前端。
6.  **展示计划:**
    - 前端在地图上标注出计划中的所有地点。
    - 同时，在地图旁边的信息面板中，以时间轴或卡片形式展示详细的每日行程。
7.  **交互与导航:**
    - 用户可以点击地图上的标注点，查看地点详情。
    s- 用户可以点击行程中的某个地点，选择“导航”，系统将跳转或调用高德地图应用进行导航。
8.  **保存与管理:** 用户可以保存这份计划，并在个人中心随时查看和修改。